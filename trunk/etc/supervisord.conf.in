[inet_http_server]
port = 9001
username = admin
password = admin

[supervisord]
logfile = ${buildout:directory}/var/log/supervisord.log
logfile_maxbytes = 50MB
logfile_backups = 10
loglevel = info
pidfile = ${buildout:directory}/var/supervisord.pid
nodaemon = false

[supervisorctl]
serverurl = http://localhost:9001

[rpcinterface:supervisor]
supervisor.rpcinterface_factory=supervisor.rpcinterface:make_main_rpcinterface

[program:memcached]
command = ${buildout:directory}/bin/memcached 
process_name = memcached
directory = ${buildout:directory}/bin
priority = 10
redirect_stderr = true
environment = LD_LIBRARY_PATH=${buildout:directory}/parts/libevent/lib
stdout_logfile = ${buildout:directory}/var/log/memcached.log

[program:mongod]
command = ${buildout:directory}/bin/mongod --dbpath=${buildout:directory}/var
process_name = mongod
directory = ${buildout:directory}/bin
priority = 10
redirect_stderr = true
stdout_logfile = ${buildout:directory}/var/log/mongod.log

[program:rabbitmq]
command = ${buildout:directory}/bin/rabbitmq-server
process_name = rabbitmq
directory = ${buildout:directory}
priority = 10
redirect_stderr = true
stdout_logfile = ${buildout:directory}/var/log/rabbitmq-server.log

[program:intid]
command = ${buildout:directory}/bin/intid 
process_name = intid
directory = ${buildout:directory}
priority = 20
redirect_stderr = true
stdout_logfile = ${buildout:directory}/var/log/intid.log
stopsignal = INT

[program:taskworker]
command = ${buildout:directory}/bin/taskworker 
process_name = taskworker
directory = ${buildout:directory}
priority = 20
redirect_stderr = true
stdout_logfile = ${buildout:directory}/var/log/taskworker.log

[program:deferred_taskworker]
command = ${buildout:directory}/bin/deferred_taskworker 
process_name = deferred_taskworker
directory = ${buildout:directory}
priority = 20
redirect_stderr = true
stdout_logfile = ${buildout:directory}/var/log/deferred_taskworker.log

[fcgi-program:appserver]
command = ${buildout:directory}/bin/appserver
socket = tcp://localhost:8081
process_name = %(program_name)s_%(process_num)02d
numprocs = 2
priority = 999
autostart = true 
autorestart = unexpected
startsecs = 1
startretries = 3
exitcodes = 0,2
stopsignal = QUIT
stopwaitsecs = 10
redirect_stderr = true
stdout_logfile = ${buildout:directory}/var/log/appserver.log
stdout_logfile_maxbytes = 1MB
stdout_logfile_backups = 10
stderr_logfile = ${buildout:directory}/var/log/appserver-error.log
stderr_logfile_maxbytes = 1MB

[program:nginx]
command = ${buildout:directory}/parts/nginx/sbin/nginx -c ${buildout:directory}/parts/nginxctl/nginxctl.conf
process_name = nginx
directory = ${buildout:directory}/parts/nginx/sbin
priority = 30
environment = LD_LIBRARY_PATH=${buildout:directory}/parts/pcre/lib
redirect_stderr = true
